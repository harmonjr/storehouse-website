---
import { getCollection } from 'astro:content';
import BlogCard from '../../BlogCard.astro';

const allBlogPosts = await getCollection('blog');
const recentPosts = allBlogPosts
  .sort((a, b) => b.data.publishDate.valueOf() - a.data.publishDate.valueOf())
  .slice(0, 3);
---

{recentPosts.length > 0 && (
  <section class="py-16 bg-white">
    <div class="mx-auto max-w-5xl px-4 sm:px-6 lg:px-8">
      <div class="text-center mb-10">
        <h2 class="font-display text-2xl sm:text-3xl font-semibold text-slate-900">
          More from the blog
        </h2>
        <p class="mt-2 text-slate-600">
          Practical articles on stewardship, margin, and money.
        </p>
      </div>

      <div class="grid md:grid-cols-2 lg:grid-cols-3 gap-8">
        {recentPosts.map((post) => (
          <BlogCard
            title={post.data.title}
            description={post.data.description}
            slug={post.id}
            publishDate={post.data.publishDate}
            category={post.data.category}
            featured={post.data.featured}
          />
        ))}
      </div>

      <div class="mt-8 text-center">
        <a
          href="/blog"
          class="inline-flex items-center text-sm font-medium text-storehouse-600 hover:text-storehouse-700 transition-colors"
        >
          View all posts &rarr;
        </a>
      </div>
    </div>
  </section>
)}
